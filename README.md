# Deep learning. Компьютерное зрение
## Определение возраста покупателей по фото

**Стек:** tensorflow / pandas / python

**Описание проекта**: Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Это поможет сделать систему рекоммендаций эффективнее - у разных возрастных категорий разные потребности. А также позволит отслеживать возможные ошибки кассиров при продаже алкоголя. 

**Задача:** Построить модель, которая по фотографии определит приблизительный возраст человека. Данные для обучения - набор пар фотография-возраст.

**Ресурсы для обучения:**  
Обучение нейросети происходило в облачном **GPU-тренажере** [Yandex Compute Cloud](https://cloud.yandex.ru/services/compute)
Видеокарта  - **Tesla V100-SXM2-32GB**

## Ход работы:


## Анализ данных
 
 В датасете фотографии людей разных возрастов распределены неравномерно:  
 > Преобладают фотографии с возрастами от 15 до 50 лет. Также, есть небольшой пик фотографий с возрастами от 0 до 3 лет. 
 
 > Еще, на гистограммах есть аномальные пики в районах "круглых" возрастов(25, 30...). Одна из возможных причин - желание взрослых людей округлить свой возраст в меньшую сторону. Этим же можно объяснить отсутсвие таких пиков для возрастов 20 и меньше.

Судя по случайным семплам изображений, датасет достаточно разнообразен - представлены люди разного гендера и разных национальностей

## Обучение модели  

В качестве загрузчика использовался ImageDataGenerator. Далее датасет разбивался на тренировочную и тестовую выборки в соотношение 75:25.  
Значения каждого пикселя изображения были приведены к масштабу 0 - 1.  
В качестве аугментаций было использовано отражение по горизонтали и поворот на 10°.  

В качестве модели была выбрана модель ResNet50 - сверточная сеть с глубиной слоев 50. 
И добавлены последними слоями - **GlobalAveragePooling2D** и **Dense слой с одним нейроном и 'relu' активацией**. 

- Оптимизатор модели = 'Adam', learning rate = 0.0001
- Функция потерь = 'mean_squared_error'
- Метрика = 'mae'

Результаты обучения:  
**MAE** на тестовой выборке: **6.2876**

## Итог:  
После обучения получили модель с метрикой **MAE 6.2**, что соответсвует поставленной задаче.

6.2 - это средняя ошибка модели, было бы интересно посмотреть в предсказании каких возрастов модель ошибается больше, а в предсказании каких меньше.